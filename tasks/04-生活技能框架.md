# ä»»åŠ¡ 04ï¼šç”Ÿæ´»æŠ€èƒ½æ¡†æ¶

## ğŸ“‹ ä»»åŠ¡ç›®æ ‡
å»ºç«‹ç”Ÿæ´»æŠ€èƒ½ç³»ç»Ÿçš„æ•°æ®æ¨¡å‹å’Œæ¡†æ¶ï¼Œå®šä¹‰æŠ€èƒ½ç±»å‹ã€å­æ¨¡å—ã€ç­‰çº§ç»éªŒç³»ç»Ÿã€‚

## ğŸ“ éœ€è¦åˆ›å»º/ä¿®æ”¹çš„æ–‡ä»¶

### åç«¯æ–‡ä»¶
```
backend/internal/model/
â”œâ”€â”€ skill.go              # æŠ€èƒ½å®šä¹‰æ¨¡å‹
â”œâ”€â”€ skill_module.go       # æŠ€èƒ½å­æ¨¡å—æ¨¡å‹
â””â”€â”€ character_skill.go    # è§’è‰²æŠ€èƒ½è¿›åº¦æ¨¡å‹

backend/internal/data/
â””â”€â”€ skills_init.go        # æŠ€èƒ½åˆå§‹åŒ–æ•°æ®

backend/internal/handler/
â””â”€â”€ skill.go              # æŠ€èƒ½ç›¸å…³æ¥å£
```

## ğŸ“ è¯¦ç»†å®ç°è¦æ±‚

### 1. æŠ€èƒ½å®šä¹‰æ¨¡å‹ (Skill)
```go
type SkillCategory string

const (
    SkillCategoryGathering SkillCategory = "gathering"  // é‡‡é›†ç±»
    SkillCategoryCrafting  SkillCategory = "crafting"   // åˆæˆç±»
    SkillCategoryCombat    SkillCategory = "combat"     // æˆ˜æ–—ç±»
    SkillCategorySpecial   SkillCategory = "special"    // ç‰¹æ®Šç±»
)

type Skill struct {
    ID          uint          `gorm:"primaryKey"`
    Code        string        `gorm:"size:50;uniqueIndex"` // woodcutting, mining, fishing, etc.
    Name        string        `gorm:"size:50"`              // ä¼æœ¨, é‡‡çŸ¿, é’“é±¼ ç­‰
    Description string        `gorm:"size:500"`
    Category    SkillCategory `gorm:"size:20"`
    Icon        string        `gorm:"size:200"`
    SortOrder   int           `gorm:"default:0"`            // æ˜¾ç¤ºæ’åº
}
```

### 2. æŠ€èƒ½å­æ¨¡å—æ¨¡å‹ (SkillModule)
```go
type SkillModule struct {
    ID               uint   `gorm:"primaryKey"`
    SkillID          uint   `gorm:"index"`            // æ‰€å±æŠ€èƒ½
    Code             string `gorm:"size:50;uniqueIndex"`
    Name             string `gorm:"size:100"`          // å¦‚ï¼šç ä¼æ©¡æ ‘ã€å¼€é‡‡é“çŸ¿
    Description      string `gorm:"size:500"`
    RequiredLevel    int    `gorm:"default:1"`        // æ‰€éœ€æŠ€èƒ½ç­‰çº§
    ExecutionTime    int    `gorm:""`                 // æ‰§è¡Œæ—¶é—´ï¼ˆç§’ï¼‰
    ExpReward        int    `gorm:""`                 // å®Œæˆè·å¾—ç»éªŒ
    
    // äº§å‡ºé…ç½®ï¼ˆJSONæ ¼å¼å­˜å‚¨ï¼‰
    // æ ¼å¼: [{"item_code": "oak_log", "quantity": 1, "chance": 1.0}]
    OutputConfig     string `gorm:"type:text"`
    
    // æ¶ˆè€—é…ç½®ï¼ˆåˆæˆç±»æŠ€èƒ½ä½¿ç”¨ï¼‰
    // æ ¼å¼: [{"item_code": "oak_log", "quantity": 2}]
    InputConfig      string `gorm:"type:text"`
    
    Skill            Skill  `gorm:"foreignKey:SkillID"`
}
```

### 3. è§’è‰²æŠ€èƒ½è¿›åº¦æ¨¡å‹ (CharacterSkill)
```go
type CharacterSkill struct {
    ID          uint `gorm:"primaryKey"`
    CharacterID uint `gorm:"index"`
    SkillID     uint `gorm:"index"`
    Level       int  `gorm:"default:1"`    // å½“å‰ç­‰çº§
    Experience  int  `gorm:"default:0"`    // å½“å‰ç»éªŒ
    
    Character   Character `gorm:"foreignKey:CharacterID"`
    Skill       Skill     `gorm:"foreignKey:SkillID"`
}
```

### 4. ç»éªŒç­‰çº§è®¡ç®—
```go
// è®¡ç®—å‡çº§æ‰€éœ€ç»éªŒï¼ˆå¯è°ƒæ•´å…¬å¼ï¼‰
func GetRequiredExp(level int) int {
    // ç®€å•å…¬å¼ï¼šæ¯çº§éœ€è¦ level * 100 ç»éªŒ
    return level * 100
}

// æ£€æŸ¥æ˜¯å¦å¯ä»¥å‡çº§
func (cs *CharacterSkill) CanLevelUp() bool {
    return cs.Experience >= GetRequiredExp(cs.Level)
}
```

### 5. åˆå§‹æŠ€èƒ½æ•°æ®
```go
var DefaultSkills = []Skill{
    // é‡‡é›†ç±»
    {Code: "woodcutting", Name: "ä¼æœ¨", Category: SkillCategoryGathering, SortOrder: 1},
    {Code: "mining", Name: "é‡‡çŸ¿", Category: SkillCategoryGathering, SortOrder: 2},
    {Code: "fishing", Name: "é’“é±¼", Category: SkillCategoryGathering, SortOrder: 3},
    {Code: "gathering", Name: "é‡‡é›†", Category: SkillCategoryGathering, SortOrder: 4},
    {Code: "farming", Name: "å…»æ®–", Category: SkillCategoryGathering, SortOrder: 5},
    
    // åˆæˆç±»
    {Code: "cooking", Name: "çƒ¹é¥ª", Category: SkillCategoryCrafting, SortOrder: 6},
    {Code: "smithing", Name: "é”»é€ ", Category: SkillCategoryCrafting, SortOrder: 7},
    {Code: "tailoring", Name: "ç¼åˆ¶", Category: SkillCategoryCrafting, SortOrder: 8},
    
    // æˆ˜æ–—ç±»
    {Code: "combat", Name: "æˆ˜æ–—", Category: SkillCategoryCombat, SortOrder: 9},
    
    // ç‰¹æ®Šç±»
    {Code: "enhancement", Name: "å¼ºåŒ–", Category: SkillCategorySpecial, SortOrder: 10},
}
```

### 6. API æ¥å£
| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| GET | /api/skills | è·å–æ‰€æœ‰æŠ€èƒ½å®šä¹‰ |
| GET | /api/skills/:code/modules | è·å–æŠ€èƒ½çš„æ‰€æœ‰å­æ¨¡å— |
| GET | /api/characters/:id/skills | è·å–è§’è‰²æ‰€æœ‰æŠ€èƒ½è¿›åº¦ |

## âœ… éªŒè¯æ£€æŸ¥ç‚¹

å®Œæˆåè¯·éªŒè¯ï¼š
1. [ ] æœåŠ¡å¯åŠ¨æ—¶è‡ªåŠ¨åˆå§‹åŒ–æ‰€æœ‰æŠ€èƒ½
2. [ ] èƒ½è·å–æŠ€èƒ½åˆ—è¡¨ï¼ŒåŒ…å«åˆ†ç±»ä¿¡æ¯
3. [ ] å­æ¨¡å—æ­£ç¡®å…³è”åˆ°æŠ€èƒ½
4. [ ] æ–°è§’è‰²åˆ›å»ºæ—¶è‡ªåŠ¨åˆå§‹åŒ–æ‰€æœ‰æŠ€èƒ½è¿›åº¦ï¼ˆç­‰çº§1ï¼Œç»éªŒ0ï¼‰
5. [ ] èƒ½è·å–è§’è‰²çš„æŠ€èƒ½è¿›åº¦åˆ—è¡¨
6. [ ] ç»éªŒå‡çº§è®¡ç®—é€»è¾‘æ­£ç¡®

## ğŸ”— ä¾èµ–å…³ç³»
- ä¾èµ–ï¼šä»»åŠ¡ 01ï¼ˆéœ€è¦ Character æ¨¡å‹ï¼‰
- ä¾èµ–ï¼šä»»åŠ¡ 02ï¼ˆå­æ¨¡å—äº§å‡ºéœ€è¦ç‰©å“ç³»ç»Ÿï¼‰
